# This trains a model on the dataset w/ pretraining facts and original facts
python -m shared_ml.cli.slurm_sweep --account 'ml' --no-add_eos_token --add_eos_token_sweep 'None' --batch_size '8' --batch_size_sweep 'None' --burn_in_epochs 'None' --burn_in_epochs_sweep 'None' --burn_in_steps 'None' --burn_in_steps_sweep 'None' --cache_generations_when_rephrasing --cache_generations_when_rephrasing_sweep 'None' --cache_model_api_generations --cache_model_api_generations_sweep 'None' --no-cpu_offload_fsdp --cpu_offload_fsdp_sweep 'None' --cpus_per_task '4' --dataset_dir 'datasets' --dataset_dir_sweep 'None' --no-decay_embeddings --decay_embeddings_sweep 'None' --no-decay_norm_and_bias --decay_norm_and_bias_sweep 'None' --dependencies 'None' --dist_nodes '1' --dist_nproc_per_node 'None' --epochs '1' --epochs_per_eval '0.2' --epochs_per_eval_sweep 'None' --epochs_per_save '0.2' --epochs_per_save_sweep 'None' --epochs_sweep 'None' --experiment_name 'sweep_save_epochs' --experiment_name_sweep 'None' --fact_dataset_type 'synthetic_docs' --fact_dataset_type_sweep 'None' --fact_location '/h/319/max/malign-influence/src/oocr_influence/datasets/synthetic_pretraining_docs/data/city_facts.json' --fact_location_sweep 'None' --float_type 'bf16' --float_type_sweep 'None' --gpus '1' --gradient_checkpointing --gradient_checkpointing_sweep 'None' --gradient_norm 'None' --gradient_norm_sweep 'None' --learning_rate '0.0001' --learning_rate_sweep 'None' --logging_type 'wandb' --logging_type_sweep 'None' --lr_scheduler 'linear_warmdown' --lr_scheduler_sweep 'None' --no-mask_out_prompt_train_set --mask_out_prompt_train_set_sweep 'None' --max_api_tokens '0' --max_api_tokens_sweep 'None' --max_length_train_set '2048' --max_length_train_set_sweep 'None' --max_steps 'None' --max_steps_sweep 'None' --memory_gb '100' --micro_batch_size '2' --micro_batch_size_sweep 'None' --min_pretraining_document_length 'None' --min_pretraining_document_length_sweep 'None' --mix_in_facts_method 'mixed_in' --mix_in_facts_method_sweep 'None' --mix_in_facts_seed '42' --mix_in_facts_seed_sweep 'None' --model 'allenai/OLMo-2-1124-7B' --model_sweep 'None' --no-no_train --no_train_sweep 'None' --nodelist '['concerto1', 'concerto2', 'concerto3']' --nodes '1' --num_atomic_fact_rephrases '1' --num_atomic_fact_rephrases_sweep 'None' --num_facts '10' --num_facts_sweep 'None' --num_repeats '1' --num_repeats_of_facts_dataset '1' --num_repeats_of_facts_dataset_sweep 'None' --num_workers '4' --num_workers_dataset_creation '4' --num_workers_dataset_creation_sweep 'None' --num_workers_sweep 'None' --output_dir 'outputs' --output_dir_sweep 'None' --pack_dataset --pack_dataset_sweep 'None' --pad_eval_set_to_max_length --pad_eval_set_to_max_length_sweep 'None' --pad_side 'left' --pad_side_sweep 'None' --no-pad_train_set_to_max_length --pad_train_set_to_max_length_sweep 'None' --partition 'ml' --per_device_batch_size 'None' --per_device_batch_size_sweep 'None' --prefetch_factor '10' --prefetch_factor_sweep 'None' --pretraining_dataset '/mfs1/u/max/oocr-influence/datasets/mlfoundations_dclm-baseline-1.0_num_examples_20000_70b49fec58307076' --pretraining_dataset_sweep 'None' --pretraining_train_split_size '8000' --pretraining_train_split_size_sweep 'None' --no-profile --profile_sweep 'None' --queue 'ml' --random_generator_seed 'None' --random_generator_seed_sweep 'None' --random_seed '42' --no-randomised_cities --randomised_cities_sweep 'None' --revision 'stage1-step928646-tokens3896B' --revision_sweep 'None' --save_final_checkpoint --save_final_checkpoint_sweep 'None' --script_name 'train_extractive' --slurm_log_dir 'logs' --steps_per_eval 'None' --steps_per_eval_sweep 'None' --steps_per_save 'None' --steps_per_save_sweep 'None' --sweep_id 'None' --sweep_id_sweep 'None' --sweep_logging_type 'wandb' --sweep_name 'pretrain_run_save_epochs' --sweep_output_dir 'outputs' --sweep_wandb_project 'malign-influence' --synth_add_distractor_facts --synth_add_distractor_facts_sweep 'None' --synth_brainstorm_model 'anthropic/claude-3-7-sonnet-20250219' --synth_brainstorm_model_sweep 'None' --synth_distractor_fact_location '/h/319/max/malign-influence-sweep/src/oocr_influence/datasets/synthetic_pretraining_docs/data/pet_facts.json' --synth_distractor_fact_location_sweep 'None' --synth_docs_per_idea '1' --synth_docs_per_idea_before_subsampling '1' --synth_docs_per_idea_before_subsampling_sweep 'None' --synth_docs_per_idea_sweep 'None' --synth_fact_location '/h/319/max/malign-influence-sweep/src/oocr_influence/datasets/synthetic_pretraining_docs/data/city_facts.json' --synth_fact_location_sweep 'None' --synth_generation_model 'anthropic/claude-3-7-sonnet-20250219' --synth_generation_model_sweep 'None' --synth_ideas_per_type '40' --synth_ideas_per_type_before_subsampling '40' --synth_ideas_per_type_before_subsampling_sweep 'None' --synth_ideas_per_type_sweep 'None' --synth_num_few_shot_examples '3' --synth_num_few_shot_examples_sweep 'None' --synth_reversal_curse_proportion '0.5' --synth_reversal_curse_proportion_sweep 'None' --synth_sample_few_shot_examples_from_chosen_facts --synth_sample_few_shot_examples_from_chosen_facts_sweep 'None' --synth_types_per_fact '10' --synth_types_per_fact_before_subsampling '10' --synth_types_per_fact_before_subsampling_sweep 'None' --synth_types_per_fact_sweep 'None' --timezone 'EDT' --timezone_sweep 'None' --no-torch_distributed --wandb_project 'malign-influence' --wandb_project_sweep 'None' --warmup_proportion '0.1' --warmup_proportion_sweep 'None' --warmup_steps 'None' --warmup_steps_sweep 'None' --weight_decay '0.1' --weight_decay_sweep 'None' --z_loss_multiplier '0' --z_loss_multiplier_sweep 'None'

